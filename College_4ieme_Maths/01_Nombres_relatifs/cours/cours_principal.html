<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cours interactif sur les nombres relatifs : règles, méthodes, quiz progressifs et exercices niveaux 1 à 3 avec fiche synthèse.">
    <title>Nombres Relatifs - Cours Interactif</title>
    
    <!-- Google Fonts pour thème gamer -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS modulaire refactorisé -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/variables.css" id="theme-variables">
</head>
<body class="has-fixed-header">
<a href="#contenu-principal" class="skip-link">Aller au contenu principal</a>
<div class="container">
    <header class="page-header" role="banner">
        <div class="header-bar">
            <h1>🔢 Nombres Relatifs - Cours Interactif 
                <div class="header-controls inline-element spaced-group">
                    <button id="global-score" class="gamer-element primary" aria-live="polite" aria-label="Score global" disabled>Score : 0 / 0</button> 
                    <button id="reset-score-btn" class="gamer-element interactive" aria-label="Réinitialiser le score" title="Réinitialiser le score">↺ Reset</button>
                    <select id="theme-selector" class="gamer-element interactive" aria-label="Sélectionner un thème" title="Changer le thème visuel">
                        <option value="default">🎨 Défaut</option>
                        <option value="classic">📚 Classique</option>
                        <option value="modern">✨ Moderne</option>
                    </select>
                </div>
            </h1>
        </div>
    <nav class="modern-nav" id="nav-main" role="navigation" aria-label="Navigation principale du chapitre">
            <button class="btn btn--secondary" onclick="showSection('introduction')">🏠 Introduction</button>
            <button class="btn btn--secondary" onclick="showSection('retention')">🔑 Règles</button>
            <button class="btn btn--secondary" onclick="showSection('phases')">📚 Quiz</button>
            <button class="btn btn--secondary" onclick="showSection('methodes')">💡 Méthodes</button>
            <button class="btn btn--secondary" onclick="showSection('pieges')">⚠️ Pièges</button>
               <button class="btn btn--secondary" onclick="showSection('plan-reactivation')" title="Plan de réactivation">🗓️ Plan</button>
            <!-- Shortcuts quick access -->
            <div class="nav-shortcuts">
                <button class="btn btn--shortcut" onclick="showSection('exercices-n1')" title="Exercice Niveau 1 (touche 1)">✏️ Exo 1</button>
                <button class="btn btn--shortcut" onclick="showSection('exercices-n2')" title="Exercice Niveau 2 (touche 2)">✏️ Exo 2</button>
                <button class="btn btn--shortcut" onclick="showSection('exercices-n3')" title="Exercice Niveau 3 (touche 3)">✏️ Exo 3</button>
                <button class="btn btn--shortcut" onclick="showSection('fiche-synthese')" title="Synthèse (touche 4 ou S)">📋 Synthèse</button>
            </div>
        </nav>
    </header>

    <!-- Section Introduction (TOUJOURS VISIBLE comme l'original) -->
    <main id="contenu-principal" tabindex="-1">
    <section id="introduction" data-section="introduction" class="content-section" aria-labelledby="heading-intro">
    <h2 id="heading-intro">🏠 Introduction aux Nombres Relatifs <span class="section-score" data-section-score="introduction">0 / 1</span></h2>
        <p class="intro-lead">Découvrons les nombres positifs et négatifs à travers des situations concrètes.</p>
        
        <div class="card highlight">
            <h3>🎯 Objectifs du cours</h3>
            <ul>
                <li>Comprendre la notion de nombres relatifs</li>
                <li>Maîtriser l'addition des nombres relatifs</li>
                <li>Appliquer les règles dans des situations concrètes</li>
            </ul>
        </div>

        <div class="grid">
            <div class="card">
                <h4>📊 Situations concrètes</h4>
                <p>Les nombres relatifs nous entourent :</p>
                <ul>
                    <li><strong>Température :</strong> +15°C ou -5°C</li>
                    <li><strong>Argent :</strong> +50€ (gain) ou -30€ (dette)</li>
                    <li><strong>Altitude :</strong> +200m ou -50m (sous la mer)</li>
                </ul>
            </div>
            
            <div class="card">
                <h4>📏 La droite graduée</h4>
                <p>Visualisation sur une droite :</p>
                <div class='svg-container'>
                   <svg viewBox='0 0 600 120' class='svg-responsive'>
                    <!-- Droite principale -->
                    <line x1='50' y1='60' x2='550' y2='60' stroke='#67c7ff' stroke-width='3'/>
                    <!-- Flèche -->
                    <polygon points='545,55 560,60 545,65' fill='#67c7ff'/>
                    
                    <!-- Graduations et nombres -->
                    <!-- -8 -->
                    <line x1='90' y1='50' x2='90' y2='70' stroke='#ff6b6b' stroke-width='3'/>
                    <circle cx='90' cy='60' r='6' fill='#ff6b6b' opacity='0.8'/>
                    <text x='90' y='85' text-anchor='middle' fill='#ff6b6b' font-size='14' font-weight='bold'>-8</text>
                    
                    <!-- -3 -->
                    <line x1='190' y1='50' x2='190' y2='70' stroke='#ff9f43' stroke-width='3'/>
                    <circle cx='190' cy='60' r='6' fill='#ff9f43' opacity='0.8'/>
                    <text x='190' y='85' text-anchor='middle' fill='#ff9f43' font-size='14' font-weight='bold'>-3</text>
                    
                    <!-- 0 (origine) -->
                    <line x1='300' y1='45' x2='300' y2='75' stroke='var(--text-primary)' stroke-width='4'/>
                    <circle cx='300' cy='60' r='8' fill='var(--text-primary)' opacity='0.9'/>
                    <text x='300' y='40' text-anchor='middle' fill='var(--text-primary)' font-size='16' font-weight='bold'>0</text>
                    <text x='300' y='100' text-anchor='middle' fill='var(--text-muted)' font-size='12'>origine</text>
                    
                    <!-- +4 -->
                    <line x1='410' y1='50' x2='410' y2='70' stroke='#10ac84' stroke-width='3'/>
                    <circle cx='410' cy='60' r='6' fill='#10ac84' opacity='0.8'/>
                    <text x='410' y='85' text-anchor='middle' fill='#10ac84' font-size='14' font-weight='bold'>+4</text>
                    
                    <!-- +7 -->
                    <line x1='480' y1='50' x2='480' y2='70' stroke='#00d2d3' stroke-width='3'/>
                    <circle cx='480' cy='60' r='6' fill='#00d2d3' opacity='0.8'/>
                    <text x='480' y='85' text-anchor='middle' fill='#00d2d3' font-size='14' font-weight='bold'>+7</text>
                    
                    <!-- Labels directionnels -->
                    <text x='150' y='25' text-anchor='middle' fill='#ff6b6b' font-size='12' font-style='italic'>← négatifs</text>
                    <text x='450' y='25' text-anchor='middle' fill='#10ac84' font-size='12' font-style='italic'>positifs →</text>
                   </svg>
                </div>
                <p><strong>Règle :</strong> Plus on va à droite, plus les nombres sont grands</p>
            </div>
        </div>

        <!-- Quiz introduction simple -->
        <div class="quiz-simple">
            <h4>🧠 Quiz rapide</h4>
            <p><strong>Quel nombre est le plus grand ?</strong></p>
            <button class="btn btn--secondary quiz-option" data-correct="false" onclick="checkAnswer(this, false)">-8</button>
            <button class="btn btn--secondary quiz-option" data-correct="true" onclick="checkAnswer(this, true)">-2</button>
            <button class="btn btn--secondary quiz-option" data-correct="false" onclick="checkAnswer(this, false)">-10</button>
            <div class="quiz-feedback" id="intro-feedback" aria-live="polite"></div>
        </div>
    </section>

    <!-- Section Règles (TOUJOURS VISIBLE) -->
    <section id="retention" data-section="retention" class="content-section">
    <h2>🎯 Les Règles Essentielles <span class="section-score" data-section-score="retention">0 / 4</span></h2>
    <p class="intro-lead">Apprends ces 3 règles pour réussir tous les calculs.</p>

        <div class="rules-grid">
            <div class="rule-card primary">
                <div class="rule-header">
                    <span class="rule-number">1</span>
                    <h3>Même signe → Addition</h3>
                </div>
                <p class="rule-text">J'additionne les valeurs absolues et je garde le signe commun.</p>
                <div class="rule-example">
                    <strong>Exemple :</strong> (+3) + (+5) = +8<br>
                    <strong>Exemple :</strong> (-4) + (-6) = -10
                </div>
                <div class="memory-tip">💡 <em>Mémo : "Même signe = j'empile"</em></div>
            </div>

            <div class="rule-card secondary">
                <div class="rule-header">
                    <span class="rule-number">2</span>
                    <h3>Signes différents → On soustrait</h3>
                </div>
                <p class="rule-text">Je soustrais les valeurs absolues, signe = celui de la plus grande valeur absolue.</p>
                <div class="rule-example">
                    <strong>Exemple :</strong> (+7) + (-3) = +4<br>
                    <strong>Exemple :</strong> (+2) + (-8) = -6
                </div>
                <div class="memory-tip">💡 <em>Mémo : "Le plus fort gagne"</em></div>
            </div>

            <div class="rule-card accent">
                <div class="rule-header">
                    <span class="rule-number">3</span>
                    <h3>Contrôle final</h3>
                </div>
                <p class="rule-text">Je teste mon résultat avec un contexte réel (température, argent, altitude).</p>
                <div class="rule-example">
                    <strong>Test :</strong> (+5) + (-12) = -7<br>
                    <em>→ "J'ai 5€, je dépense 12€ → je dois 7€" ✓</em>
                </div>
                <div class="memory-tip">💡 <em>Mémo : "Je valide le sens"</em></div>
            </div>
        </div>

        <!-- Quiz rétention -->
        <div class="retention-quiz">
            <h3>🧠 Testez votre mémorisation</h3>
            <p>Répondez par Vrai/Faux ou choisissez la bonne option :</p>

            <div class="quiz-card" data-retention-item="r1">
                <p><strong>Q1.</strong> Si les deux nombres ont le même signe, on additionne les valeurs absolues et on garde le signe commun.</p>
                <div class="mc-options" role="group" aria-label="Question 1 vrai faux">
                    <button class="btn btn--secondary" onclick="answerRetentionVF(this,'r1',true)">Vrai</button>
                    <button class="btn btn--secondary" onclick="answerRetentionVF(this,'r1',false)">Faux</button>
                </div>
                <div class="quiz-feedback" id="retention-r1" aria-live="polite"></div>
            </div>

            <div class="quiz-card" data-retention-item="r2">
                <p><strong>Q2.</strong> (+9) + (-4) : on calcule 9 - 4 puis on met toujours un signe +.</p>
                <div class="mc-options" role="group" aria-label="Question 2 vrai faux">
                    <button class="btn btn--secondary" onclick="answerRetentionVF(this,'r2',false)">Vrai</button>
                    <button class="btn btn--secondary" onclick="answerRetentionVF(this,'r2',true)">Faux</button>
                </div>
                <div class="quiz-feedback" id="retention-r2" aria-live="polite"></div>
            </div>

            <div class="quiz-card" data-retention-item="r3">
                <p><strong>Q3.</strong> Quand les signes sont différents :</p>
                <div class="mc-options" role="radiogroup" aria-label="Question 3 choix multiples">
                    <button class="btn btn--secondary" onclick="answerRetentionMC(this,'r3','A')">A. J'additionne toujours les valeurs</button>
                    <button class="btn btn--secondary" onclick="answerRetentionMC(this,'r3','B')">B. Je soustrais les valeurs absolues</button>
                    <button class="btn btn--secondary" onclick="answerRetentionMC(this,'r3','C')">C. Je prends le plus petit</button>
                </div>
                <div class="quiz-feedback" id="retention-r3" aria-live="polite"></div>
            </div>

            <div class="quiz-card" data-retention-item="r4">
                <p><strong>Q4.</strong> Contrôle final : vérifier avec une situation réelle aide à éviter les erreurs de signe.</p>
                <div class="mc-options" role="group" aria-label="Question 4 vrai faux">
                    <button class="btn btn--secondary" onclick="answerRetentionVF(this,'r4',true)">Vrai</button>
                    <button class="btn btn--secondary" onclick="answerRetentionVF(this,'r4',false)">Faux</button>
                </div>
                <div class="quiz-feedback" id="retention-r4" aria-live="polite"></div>
            </div>
        </div>
    </section>

    <!-- Section Quiz (TOUJOURS VISIBLE) -->
    <section id="phases" data-section="phases" class="content-section" aria-labelledby="heading-quiz">
        <h2 id="heading-quiz">📚 Quiz Progressifs <span class="section-score" data-section-score="phases">0 / 9</span></h2>
        <!-- Navigation retirée à la demande (phase nav & intro lead) -->

    <!-- Phase 1 -->
    <div id="phase-1" class="quiz-phase active">
            <h3>🟢 Phase 1 : Premiers pas</h3>
            <p>Calculs avec des nombres simples.</p>
            
            <div class="quiz-question">
                <h4>Question 1</h4>
                <p>Calcule : (+7) + (-5) = ?</p>
                <input type="text" id="phase1-q1" placeholder="Votre réponse" aria-label="Réponse phase 1 question 1">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase1-q1', '+2', 'Signes différents : 7-5=2, signe de +7 → +2')">✓ Valider</button>
                <div class="quiz-feedback" id="phase1-q1-feedback" aria-live="polite"></div>
            </div>

            <div class="quiz-question">
                <h4>Question 2</h4>
                <p>Calcule : (-8) + (+5) = ?</p>
                <input type="text" id="phase1-q2" placeholder="Votre réponse" aria-label="Réponse phase 1 question 2">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase1-q2', '-3', 'Signes différents : 8-5=3, signe de -8 → -3')">✓ Valider</button>
                <div class="quiz-feedback" id="phase1-q2-feedback" aria-live="polite"></div>
            </div>

            <div class="quiz-question">
                <h4>Question 3</h4>
                <p>Calcule : (+4) + (+5) = ?</p>
                <input type="text" id="phase1-q3" placeholder="Votre réponse" aria-label="Réponse phase 1 question 3">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase1-q3', '+9', 'Même signe positif : 4+5=9 → +9')">✓ Valider</button>
                <div class="quiz-feedback" id="phase1-q3-feedback" aria-live="polite"></div>
            </div>
        </div>

        <!-- Phase 2 -->
        <div id="phase-2" class="quiz-phase">
            <hr class="phase-separator" aria-hidden="true">
            <h3>🟡 Phase 2 : Pratique autonome</h3>
            <p>Maîtrisez différents types de calculs.</p>
            
            <div class="quiz-question">
                <h4>Question 1</h4>
                <p>Calcule : (-9) + (+4) = ?</p>
                <input type="text" id="phase2-q1" placeholder="Votre réponse" aria-label="Réponse phase 2 question 1">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase2-q1', '-5', 'Signes différents : 9-4=5, signe de -9 → -5')">✓ Valider</button>
                <div class="quiz-feedback" id="phase2-q1-feedback" aria-live="polite"></div>
            </div>

            <div class="quiz-question">
                <h4>Question 2</h4>
                <p>Calcule : (+15) + (-4) = ?</p>
                <input type="text" id="phase2-q2" placeholder="Votre réponse" aria-label="Réponse phase 2 question 2">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase2-q2', '+11', 'Signes différents : 15-4=11, signe de +15 → +11')">✓ Valider</button>
                <div class="quiz-feedback" id="phase2-q2-feedback" aria-live="polite"></div>
            </div>

            <div class="quiz-question">
                <h4>Question 3</h4>
                <p>Calcule : (-7) + (-5) = ?</p>
                <input type="text" id="phase2-q3" placeholder="Votre réponse" aria-label="Réponse phase 2 question 3">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase2-q3', '-12', 'Même signe négatif : 7+5=12 → -12')">✓ Valider</button>
                <div class="quiz-feedback" id="phase2-q3-feedback" aria-live="polite"></div>
            </div>
        </div>

        <!-- Phase 3 -->
        <div id="phase-3" class="quiz-phase">
            <hr class="phase-separator" aria-hidden="true">
            <h3>🔴 Phase 3 : Maîtrise</h3>
            <p>Situations avancées et cas spéciaux.</p>
            
            <div class="quiz-question">
                <h4>Question 1</h4>
                <p>Calcule : (+10) + (-4) = ?</p>
                <input type="text" id="phase3-q1" placeholder="Votre réponse" aria-label="Réponse phase 3 question 1">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase3-q1', '+6', 'Signes différents : 10-4=6, signe de +10 → +6')">✓ Valider</button>
                <div class="quiz-feedback" id="phase3-q1-feedback" aria-live="polite"></div>
            </div>

            <div class="quiz-question">
                <h4>Question 2</h4>
                <p>Calcule : (-3) + (-5) = ?</p>
                <input type="text" id="phase3-q2" placeholder="Votre réponse" aria-label="Réponse phase 3 question 2">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase3-q2', '-8', 'Même signe négatif : 3+5=8 → -8')">✓ Valider</button>
                <div class="quiz-feedback" id="phase3-q2-feedback" aria-live="polite"></div>
            </div>

            <div class="quiz-question">
                <h4>Question 3 - Cas spécial</h4>
                <p>Calcule : (+7) + (-7) = ?</p>
                <input type="text" id="phase3-q3" placeholder="Votre réponse" aria-label="Réponse phase 3 question 3">
                <button class="btn btn--primary" onclick="checkPhaseAnswer('phase3-q3', '0', 'Nombres opposés : ils s\'annulent → 0')">✓ Valider</button>
                <div class="quiz-feedback" id="phase3-q3-feedback" aria-live="polite"></div>
            </div>
        </div>
    </section>

    <!-- Section Méthodes (TOUJOURS VISIBLE) -->
    <section id="methodes" data-section="methodes" class="content-section" aria-labelledby="heading-methodes">
        <h2 id="heading-methodes">💡 Méthode Illustrée <span class="section-score" data-section-score="methodes">0 / 3</span></h2>
        <p class="intro-lead">3 étapes simples pour ne jamais se tromper !</p>

        <div class="method-steps grid-auto">
            <div class="card method-step">
                <div class="step-header">
                    <span class="step-number">1</span>
                    <h3>Identifier les signes</h3>
                </div>
                <p>Je repère : même signe ou signes différents ?</p>
                <div class="step-example">
                    <strong>Exemple :</strong> (+5) + (-3) → signes différents.
                </div>
                <div class="guided-question" aria-labelledby="method-step1-title">
                    <p><strong>Exo guidé :</strong> Dans (-8) + (+3), les signes sont-ils identiques ?</p>
                    <button class="btn btn--secondary" onclick="checkMethodStep(1, false, 'Non, ils sont différents : - et +')">Oui</button>
                    <button class="btn btn--secondary" onclick="checkMethodStep(1, true, 'Correct ! Signes différents')">Non</button>
                    <div class="quiz-feedback" id="method-step1-feedback" aria-live="polite"></div>
                </div>
            </div>
            <div class="card method-step">
                <div class="step-header">
                    <span class="step-number">2</span>
                    <h3>Appliquer la règle</h3>
                </div>
                <p><strong>Même signe :</strong> j'additionne. <strong>Différents :</strong> je soustrais la plus petite valeur.</p>
                <div class="step-example"><strong>Suite :</strong> 8 - 3 = 5 (valeurs absolues)</div>
                <div class="guided-question">
                    <p><strong>Exo guidé :</strong> Quelle opération pour (-8) + (+3) ?</p>
                    <button class="btn btn--secondary" onclick="checkMethodStep(2, false, 'Pas une addition : les signes sont différents')">Addition 8 + 3</button>
                    <button class="btn btn--secondary" onclick="checkMethodStep(2, true, 'Correct : on soustrait 8 - 3 = 5')">On soustrait 8 - 3</button>
                    <div class="quiz-feedback" id="method-step2-feedback" aria-live="polite"></div>
                </div>
            </div>
            <div class="card method-step">
                <div class="step-header">
                    <span class="step-number">3</span>
                    <h3>Vérifier & Signe</h3>
                </div>
                <p>Je prends le signe du nombre de plus grande valeur absolue.</p>
                <div class="step-example"><strong>Plus grande valeur :</strong> 8 (négatif)</div>
                <div class="guided-question">
                    <p><strong>Exo guidé :</strong> Signe final de (-8) + (+3) ?</p>
                    <button class="btn btn--secondary" onclick="checkMethodStep(3, false, 'Non : 8 est négatif, donc signe -')">+</button>
                    <button class="btn btn--secondary" onclick="checkMethodStep(3, true, 'Correct : résultat -5')">-</button>
                    <div class="quiz-feedback" id="method-step3-feedback" aria-live="polite"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Pièges (TOUJOURS VISIBLE) -->
    <section id="pieges" data-section="pieges" class="content-section" aria-labelledby="heading-pieges">
    <h2 id="heading-pieges">⚠️ Pièges à Éviter <span class="section-score" data-section-score="pieges">0 / 2</span></h2>
        <p class="intro-lead">Identifiez les erreurs les plus courantes pour ne plus les refaire !</p>

        <div class="pitfalls-grid">
            <div class="pitfall-card error">
                <h3>❌ Erreur n°1 : Retirer mécaniquement (appliquer une “soustraction réflexe” sans analyser les signes)</h3>
                <div class="wrong-example">
                    <strong>❌ Faux :</strong> (+3) + (-7) = +4<br>
                    <em>Erreur détaillée : On compare seulement 7 et 3 et on conserve « le signe du plus grand » au lieu d'appliquer la règle signes différents → soustraction avec signe du plus grand en valeur absolue.</em>
                </div>
                <div class="correct-example">
                    <strong>✅ Correct :</strong> 7 - 3 = 4, signe de -7 → <strong>-4</strong><br>
                    <em>Méthode : Signes différents → je soustrais (7-3) = 4 puis je prends le signe du nombre de plus grande valeur absolue : -7.</em>
                </div>
                <div class="mini-trap-quiz" data-trap-id="trap-q1">
                    <p class="mini-trap-title">🧠 Quiz Anti-Piège (Erreur n°1)</p>
                    <p>Dans (+9) + (-4), pourquoi le résultat n'est-il pas -5 ?</p>
                    <button class="btn btn--secondary trap-option" onclick="checkTrap(this,true,'Correct : signes différents → 9 - 4 = 5 avec signe +','trap-q1')" data-correct="true">Parce que on fait 9 - 4 et le signe vient de +9</button>
                    <button class="btn btn--secondary trap-option" onclick="checkTrap(this,false,'Non : ce n\'est pas une addition de deux négatifs','trap-q1')" data-correct="false">Parce que on additionne 9 et 4</button>
                    <div class="quiz-feedback" aria-live="polite"></div>
                </div>
            </div>

            <div class="pitfall-card warning">
                <h3>⚠️ Piège n°2 : Confondre addition de nombres négatifs avec une soustraction classique</h3>
                <div class="wrong-example">
                    <strong>❌ Faux :</strong> (-5) + (-3) = -2<br>
                    <em>Erreur détaillée : L'élève traite (+) comme une opération « je prends la différence » au lieu d'additionner les valeurs absolues puisque les signes sont identiques.</em>
                </div>
                <div class="correct-example">
                    <strong>✅ Correct :</strong> Même signe → 5 + 3 = 8 → <strong>-8</strong><br>
                    <em>Méthode : Même signe → j'additionne les valeurs : 5 + 3 = 8 puis je garde le signe commun (négatif).</em>
                </div>
                <div class="mini-trap-quiz" data-trap-id="trap-q2">
                    <p class="mini-trap-title">🧠 Quiz Anti-Piège (Piège n°2)</p>
                    <p>Pourquoi (-7) + (-2) n'est pas -5 + 2 ?</p>
                    <button class="btn btn--secondary trap-option" onclick="checkTrap(this,true,'Exact : on additionne les valeurs absolues car même signe','trap-q2')" data-correct="true">Parce qu'il faut additionner 7 et 2 → 9 puis mettre -</button>
                    <button class="btn btn--secondary trap-option" onclick="checkTrap(this,false,'Non : ce n\'est pas une différence, ce sont deux négatifs','trap-q2')" data-correct="false">Parce qu'on doit soustraire 7 - 2</button>
                    <div class="quiz-feedback" aria-live="polite"></div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- ==========================
     Exercices intégrés (Niveau 1,2,3)
     ========================== -->

<div class="container">
<section id="exercices-n1" data-section="exercices-n1" class="content-section" aria-labelledby="heading-exos-n1">
    <h2 id="heading-exos-n1">✏️ Exos - Niveau 1 (Découverte) <span class="section-score" data-section-score="exercices-n1">0 / 5</span></h2>
    <p>Exercices guidés pour s'entraîner sur les notions de base.</p>
    <div class="grid-auto">
        <div class="card">
            <h3>Exo 1 – + et - basiques</h3>
            <p>Calcule : (+5) + (-3)</p>
            <div class="exercise" data-expected="+2|2">
                <label for="ex-n1-1" class="visually-hidden">Réponse exercice 1</label>
                <input id="ex-n1-1" type="text" placeholder="Votre réponse" aria-describedby="ex-n1-1-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n1-1-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_1_1" onclick="toggleSolution('sol_01_Nombres_relatifs_1_1', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_1_1" class="solution"><p><strong>Indice :</strong> Signes différents → on soustrait les valeurs absolues.</p><p><strong>Solution :</strong> 5 - 3 = 2, signe de +5 → +2</p></div>
        </div>
        <div class="card">
            <h3>Exo 2 – Températures</h3>
            <p>Matin : -2°C, après-midi : +4°C. Variation ?</p>
            <div class="exercise" data-expected="+6|6|+6c|6c">
                <label for="ex-n1-2" class="visually-hidden">Réponse exercice 2</label>
                <input id="ex-n1-2" type="text" placeholder="Votre réponse" aria-describedby="ex-n1-2-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n1-2-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_1_2" onclick="toggleSolution('sol_01_Nombres_relatifs_1_2', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_1_2" class="solution"><p><strong>Indice :</strong> Variation = température finale - température initiale.</p><p><strong>Solution :</strong> (+4) - (-2) = (+4) + (+2) = +6°C</p></div>
        </div>
        <div class="card">
            <h3>Exo 3 – Argent</h3>
            <p>Lucas a -15€ sur son compte. Il reçoit 8€. Quel est son nouveau solde ?</p>
            <div class="exercise" data-expected="-7|7-">
                <label for="ex-n1-3" class="visually-hidden">Réponse exercice 3</label>
                <input id="ex-n1-3" type="text" placeholder="Votre réponse" aria-describedby="ex-n1-3-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n1-3-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_1_3" onclick="toggleSolution('sol_01_Nombres_relatifs_1_3', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_1_3" class="solution"><p><strong>Indice :</strong> Recevoir de l'argent = addition positive.</p><p><strong>Solution :</strong> (-15) + (+8) = -(15-8) = -7€</p></div>
        </div>
        <div class="card">
            <h3>Exo 4 – Même signe négatif</h3>
            <p>Calcule : (-2) + (-6)</p>
            <div class="exercise" data-expected="-8|8-">
                <label for="ex-n1-4" class="visually-hidden">Réponse exercice 4</label>
                <input id="ex-n1-4" type="text" placeholder="Votre réponse" aria-describedby="ex-n1-4-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n1-4-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_1_4" onclick="toggleSolution('sol_01_Nombres_relatifs_1_4', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_1_4" class="solution"><p><strong>Règle :</strong> Même signe → j'additionne les valeurs absolues : 2 + 6 = 8 et je garde le signe -.</p><p><strong>Solution :</strong> -8</p></div>
        </div>
        <div class="card">
            <h3>Exo 5 – Signes différents</h3>
            <p>Calcule : (+7) + (-9)</p>
            <div class="exercise" data-expected="-2|2-">
                <label for="ex-n1-5" class="visually-hidden">Réponse exercice 5</label>
                <input id="ex-n1-5" type="text" placeholder="Votre réponse" aria-describedby="ex-n1-5-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n1-5-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_1_5" onclick="toggleSolution('sol_01_Nombres_relatifs_1_5', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_1_5" class="solution"><p><strong>Règle :</strong> Signes différents → on soustrait 9 - 7 = 2 puis signe du plus grand (9 négatif).</p><p><strong>Solution :</strong> -2</p></div>
        </div>
        <!-- autres exercices N1... -->
    </div>
 </section>
</div>

<div class="container">
<section id="exercices-n2" data-section="exercices-n2" class="content-section" aria-labelledby="heading-exos-n2">
    <h2 id="heading-exos-n2">✏️ Exos - Niveau 2 (Pratique) <span class="section-score" data-section-score="exercices-n2">0 / 10</span></h2>
    <p>Exercices d'application pour automatiser les règles.</p>
    <div class="grid-auto">
        <div class="card">
            <h3>Exo 1 – Somme multiple</h3>
            <p>(-7) + (+12) + (-5)</p>
            <div class="exercise" data-expected="0|+0">
                <label for="ex-n2-1" class="visually-hidden">Réponse exercice 1 N2</label>
                <input id="ex-n2-1" type="text" placeholder="Votre réponse" aria-describedby="ex-n2-1-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n2-1-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_2_1" onclick="toggleSolution('sol_01_Nombres_relatifs_2_1', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_2_1" class="solution"><p><strong>Méthode :</strong> Regrouper par signes : (+12) et (-7-5).</p><p><strong>Solution :</strong> (+12) + (-12) = 0</p></div>
        </div>
        <div class="card">
            <h3>Exo 2 – On soustrait</h3>
            <p>(-15) - (-9)</p>
            <div class="exercise" data-expected="-6|6-">
                <label for="ex-n2-2" class="visually-hidden">Réponse exercice 2 N2</label>
                <input id="ex-n2-2" type="text" placeholder="Votre réponse" aria-describedby="ex-n2-2-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n2-2-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_2_2" onclick="toggleSolution('sol_01_Nombres_relatifs_2_2', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_2_2" class="solution"><p><strong>Méthode :</strong> Transformer : -(-9) = +9.</p><p><strong>Solution :</strong> (-15) + (+9) = -(15-9) = -6</p></div>
        </div>
        <div class="card">
            <h3>Exo 3 – Trois termes variés</h3>
            <p>(+18) + (-11) + (-4)</p>
            <div class="exercise" data-expected="+3|3">
                <label for="ex-n2-3" class="visually-hidden">Réponse exercice 3 N2</label>
                <input id="ex-n2-3" type="text" placeholder="Votre réponse" aria-describedby="ex-n2-3-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n2-3-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_2_3" onclick="toggleSolution('sol_01_Nombres_relatifs_2_3', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_2_3" class="solution"><p><strong>Méthode :</strong> Regrouper : (+18) + (-11 -4) = (+18) + (-15) = +(18-15) = +3.</p><p><strong>Solution :</strong> +3</p></div>
        </div>
        <div class="card">
            <h3>Exo 4 – Deux positifs, un grand négatif</h3>
            <p>(+6) + (+2) + (-15)</p>
            <div class="exercise" data-expected="-7|7-">
                <label for="ex-n2-4" class="visually-hidden">Réponse exercice 4 N2</label>
                <input id="ex-n2-4" type="text" placeholder="Votre réponse" aria-describedby="ex-n2-4-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n2-4-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_2_4" onclick="toggleSolution('sol_01_Nombres_relatifs_2_4', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_2_4" class="solution"><p><strong>Méthode :</strong> (+6)+(+2)=+8 puis +8 + (-15) = -(15-8) = -7.</p><p><strong>Solution :</strong> -7</p></div>
        </div>
        <div class="card">
            <h3>Exo 5 – Deux négatifs + un positif</h3>
            <p>(-9) + (-3) + (+5)</p>
            <div class="exercise" data-expected="-7|7-">
                <label for="ex-n2-5" class="visually-hidden">Réponse exercice 5 N2</label>
                <input id="ex-n2-5" type="text" placeholder="Votre réponse" aria-describedby="ex-n2-5-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n2-5-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_2_5" onclick="toggleSolution('sol_01_Nombres_relatifs_2_5', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_2_5" class="solution"><p><strong>Méthode :</strong> (-9)+(-3) = -12 puis -12 + (+5) = -(12-5) = -7.</p><p><strong>Solution :</strong> -7</p></div>
        </div>
        <!-- autres exercices N2... -->
    </div>
</section>
</div>

<div class="container">
<section id="exercices-n3" data-section="exercices-n3" class="content-section" aria-labelledby="heading-exos-n3">
    <h2 id="heading-exos-n3">✏️ Exos - Niveau 3 (Défi) <span class="section-score" data-section-score="exercices-n3">0 / 15</span></h2>
    <p>Exercices avancés pour approfondir et transférer.</p>
    <div class="grid-auto">
        <div class="card">
            <h3>Exo 1 – Expression complexe</h3>
            <p>Simplifier : (-4) + (+9) - (+3) - (-2)</p>
            <div class="exercise" data-expected="+4|4">
                <label for="ex-n3-1" class="visually-hidden">Réponse exercice 1 N3</label>
                <input id="ex-n3-1" type="text" placeholder="Votre réponse" aria-describedby="ex-n3-1-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n3-1-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_3_1" onclick="toggleSolution('sol_01_Nombres_relatifs_3_1', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_3_1" class="solution"><p><strong>Étapes :</strong> (-4) + (+9) + (-3) + (+2) = (-7) + (+11) = +4</p><p><strong>Solution :</strong> +4</p></div>
        </div>
        <div class="card">
            <h3>Exo 2 – Alternance signes</h3>
            <p>(+12) + (-5) - (-7) + (-10)</p>
            <div class="exercise" data-expected="+4|4">
                <label for="ex-n3-2" class="visually-hidden">Réponse exercice 2 N3</label>
                <input id="ex-n3-2" type="text" placeholder="Votre réponse" aria-describedby="ex-n3-2-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n3-2-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_3_2" onclick="toggleSolution('sol_01_Nombres_relatifs_3_2', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_3_2" class="solution"><p><strong>Méthode :</strong> -(-7)=+7 donc (+12) + (-5) + (+7) + (-10) = (12-5)=7; 7+7=14; 14-10=4.</p><p><strong>Solution :</strong> +4</p></div>
        </div>
        <div class="card">
            <h3>Exo 3 – Compensation</h3>
            <p>(-8) + (+3) + (-6) - (-5)</p>
            <div class="exercise" data-expected="-6|6-">
                <label for="ex-n3-3" class="visually-hidden">Réponse exercice 3 N3</label>
                <input id="ex-n3-3" type="text" placeholder="Votre réponse" aria-describedby="ex-n3-3-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n3-3-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_3_3" onclick="toggleSolution('sol_01_Nombres_relatifs_3_3', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_3_3" class="solution"><p><strong>Méthode :</strong> -(-5)=+5 donc (-8)+(+3)+(-6)+(+5) = (-5)+(-6)+(+5) = (-11)+(+5) = -6.</p><p><strong>Solution :</strong> -6</p></div>
        </div>
        <div class="card">
            <h3>Exo 4 – Décomposition</h3>
            <p>(+20) - (-4) + (-15) + (-3)</p>
            <div class="exercise" data-expected="+6|6">
                <label for="ex-n3-4" class="visually-hidden">Réponse exercice 4 N3</label>
                <input id="ex-n3-4" type="text" placeholder="Votre réponse" aria-describedby="ex-n3-4-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n3-4-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_3_4" onclick="toggleSolution('sol_01_Nombres_relatifs_3_4', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_3_4" class="solution"><p><strong>Méthode :</strong> -(-4)=+4 donc (+20)+(+4)=+24 puis +24+(-15)+(-3)= +24 -18 = +6.</p><p><strong>Solution :</strong> +6</p></div>
        </div>
        <div class="card">
            <h3>Exo 5 – Regroupement</h3>
            <p>(-10) + (-2) + (+9) + (+5)</p>
            <div class="exercise" data-expected="+2|2">
                <label for="ex-n3-5" class="visually-hidden">Réponse exercice 5 N3</label>
                <input id="ex-n3-5" type="text" placeholder="Votre réponse" aria-describedby="ex-n3-5-fb">
                <button class="btn btn--primary" onclick="checkExerciseAnswer(this)">Valider</button>
                <div id="ex-n3-5-fb" class="exercise-feedback" aria-live="polite"></div>
            </div>
            <button class="toggle" aria-expanded="false" aria-controls="sol_01_Nombres_relatifs_3_5" onclick="toggleSolution('sol_01_Nombres_relatifs_3_5', this)">Besoin d'aide ?</button>
            <div id="sol_01_Nombres_relatifs_3_5" class="solution"><p><strong>Méthode :</strong> Regrouper les positifs : (+9)+(+5)=+14 et les négatifs : (-10)+(-2) = -12 puis +14 + (-12) = +2.</p><p><strong>Solution :</strong> +2</p></div>
        </div>
        <!-- autres exercices N3... -->
    </div>
</section>
</div>

<!-- ==========================
     Fiche synthèse intégrée
     ========================== -->
<section id="fiche-synthese" data-section="fiche-synthese" class="content-section" aria-labelledby="heading-synthese">
    <h2 id="heading-synthese">📋 Fiche Synthèse <span class="section-score" data-section-score="fiche-synthese">0 / 3</span></h2>
    <div class="card">
    <h3>Règles essentielles <small class="note-inline">(valeur absolue = distance à 0)</small></h3>
        <div class="regle-box regle-positive">
            <h4>RÈGLE 1 : Même signe</h4>
            <p>Additionner les valeurs et garder le signe commun.</p>
            <fieldset class="self-eval" aria-label="Auto-évaluation confiance règle 1" >
                <legend class="self-eval-legend">Ton niveau de confiance sur l'utilisation de la règle « même signe → j'additionne » ?</legend>
                <label><input type="radio" name="eval-r1" value="confiant"> Confiant</label>
                <label><input type="radio" name="eval-r1" value="moyen"> Moyen / hésitant</label>
                <label><input type="radio" name="eval-r1" value="pas-confiant"> Pas confiant</label>
            </fieldset>
        </div>
        <div class="regle-box regle-negative">
            <h4>RÈGLE 2 : Signes différents</h4>
            <p>Soustraire la plus petite de la plus grande, garder le signe du plus fort.</p>
            <fieldset class="self-eval" aria-label="Auto-évaluation confiance règle 2">
                <legend class="self-eval-legend">Ton niveau de confiance sur l'utilisation de la règle « signes différents → je soustrais » ?</legend>
                <label><input type="radio" name="eval-r2" value="confiant"> Confiant</label>
                <label><input type="radio" name="eval-r2" value="moyen"> Moyen / hésitant</label>
                <label><input type="radio" name="eval-r2" value="pas-confiant"> Pas confiant</label>
            </fieldset>
        </div>
        <div class="regle-box regle-neutre">
            <h4>RÈGLE 3 : Contrôle</h4>
            <p>Vérifier le résultat dans un contexte concret (température, argent, déplacement).</p>
            <fieldset class="self-eval" aria-label="Auto-évaluation confiance règle 3">
                <legend class="self-eval-legend">Ton niveau de confiance sur l'utilisation de la règle « contrôle par contexte » ?</legend>
                <label><input type="radio" name="eval-r3" value="confiant"> Confiant</label>
                <label><input type="radio" name="eval-r3" value="moyen"> Moyen / hésitant</label>
                <label><input type="radio" name="eval-r3" value="pas-confiant"> Pas confiant</label>
            </fieldset>
        </div>
    </div>
 </section>
 <section id="plan-reactivation" data-section="plan-reactivation" class="content-section" aria-labelledby="heading-plan-reactivation">
    <h2 id="heading-plan-reactivation">🗓️ 8. Plan de réactivation <span class="section-score" data-section-score="plan-reactivation">0 / 4</span></h2>
    <p id="plan-base-date" class="plan-base-date" aria-live="polite"></p>
    <p class="plan-intro">Ce plan te dit quoi refaire : Règles → Quiz → Méthodes → Pièges → Exercices (Niveau 1 puis Niveau 2 puis Niveau 3) → Synthèse. Les révisions sont espacées pour que l'information s'installe mieux dans ta mémoire.</p>
    <div id="reactivation-list" class="reactivation-plan" aria-describedby="plan-base-date"></div>
    <div class="plan-legend">
        <span><strong>🎯 Objectif :</strong> item d'entraînement ciblé</span>
        <span><strong>📅</strong> = ajouter au Google Agenda (17h, 30 min)</span>
    </div>
 </section>
 </main>

<!-- JavaScript Externalisés -->
<script src="scripts/scoring.js" defer></script>
<script src="scripts/theme-manager.js" defer></script>
<script src="scripts/main.js" defer></script>
<script>
    // Appliquer les variables CSS aux éléments SVG
    document.addEventListener('DOMContentLoaded', function() {
        const root = document.documentElement;
        const computedStyle = getComputedStyle(root);
        
        // Récupérer les couleurs des variables CSS
        const colors = {
            primary: computedStyle.getPropertyValue('--primary').trim(),
            mathPositive: computedStyle.getPropertyValue('--math-positive').trim(),
            mathNegative: computedStyle.getPropertyValue('--math-negative').trim(),
            mathNeutral: computedStyle.getPropertyValue('--math-neutral').trim(),
            mathHighlight: computedStyle.getPropertyValue('--math-highlight').trim()
        };
        
        // Appliquer aux éléments SVG
        document.querySelectorAll('svg line, svg polygon').forEach(el => {
            if (el.getAttribute('stroke') === '#67c7ff' || el.getAttribute('fill') === '#67c7ff') {
                if (el.hasAttribute('stroke')) el.setAttribute('stroke', colors.primary);
                if (el.hasAttribute('fill')) el.setAttribute('fill', colors.primary);
            }
        });
        
        document.querySelectorAll('svg circle, svg text').forEach(el => {
            const fill = el.getAttribute('fill');
            if (fill === '#ff6b6b') el.setAttribute('fill', colors.mathNegative);
            if (fill === '#ff9f43') el.setAttribute('fill', colors.mathNeutral);
            if (fill === '#10ac84') el.setAttribute('fill', colors.mathPositive);
            if (fill === '#00d2d3') el.setAttribute('fill', colors.mathHighlight);
        });
    });
</script>
</body>
</html>